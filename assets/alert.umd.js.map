{"version":3,"file":"alert.umd.js","sources":["../lib/alert.js"],"sourcesContent":["\n(!function (window) {\n  const KEYS = { ENTER: 13, ESC: 27, SPACE: 32 };\n\n  const WINDOW_EL = 'alert-window';\n  const WINDOW_TITLE = 'alert-window-title';\n  const WINDOW_TEXT = 'alert-window-text';\n  const WINDOW_BODY = 'alert-window-body';\n  const WINDOW_HEADER = 'alert-window-header';\n  const WINDOW_FOOTER = 'alert-window-footer';\n  const WINDOW_CONTAINER = 'alert-window-container';\n\n  const WINDOW_BTN = 'alert-window-btn';\n  const WINDOW_BTN_OK = 'alert-window-btn-ok';\n  const WINDOW_BTN_CANCEL = 'alert-window-btn-cancel';\n  const WINDOW_BTN_SUBMIT = 'alert-window-btn-submit';\n\n  class AlertWindow {\n    constructor() {\n      this.labels = {\n        ok: \"OK\",\n        cancel: \"Cancel\"\n      }\n\n      this.elements = {\n        body: `<div class=${WINDOW_EL}></div>`,\n        buttons: {\n          submit: `<button type=\"submit\" class=\"${WINDOW_BTN} ${WINDOW_BTN_SUBMIT}\">{{ok}}</button>`,\n          ok: `<button class=\"${WINDOW_BTN} ${WINDOW_BTN_OK}\">{{ok}}</button>`,\n          cancel: `<button class=\"${WINDOW_BTN} ${WINDOW_BTN_CANCEL}\">{{cancel}}</button>`\n        },\n\n        title: `<p class=\"${WINDOW_TITLE}\">{{title}}</p>`,\n        text: `<p class=\"${WINDOW_TEXT}\">{{text}}</p>`,\n      }\n\n      this.init = this.init.bind(this);\n      this.setup = this.setup.bind(this);\n      this.dialog = this.dialog.bind(this);\n      this.alertSet = this.alertSet.bind(this);\n      this.addListeners = this.addListeners.bind(this);\n\n      this.alert = this.alertSet('alert');\n      this.confirm = this.alertSet('confirm');\n    }\n\n    init() {\n      this.elWindow = $.el(this.elements.body);\n      return pipe(\n        // css\n        $.setCss(['position', 'fixed']),\n        $.setCss(['top', 0]),\n        $.setCss(['left', 0]),\n        $.setCss(['right', 0]),\n        $.setCss(['bottom', 0]),\n        $.setCss(['background', 'rgba(0, 0, 0, 0.2)']),\n        $.setCss(['z-index', 1000]),\n        // append\n        $.append($('body')),\n      )(this.elWindow);\n    }\n\n    setup(item) {\n      this.elWindow = $(`.${WINDOW_EL}`);\n      this.elWindow.innerHTML = this.build(item);\n\n      pipe(\n        $.setCss(['position', 'relative']),\n        $.setCss(['top', '25%']),\n        $.setCss(['left', '50%']),\n        $.setCss(['transform', 'translate(-50%,-50%)']),\n        $.setCss(['background', '#fff']),\n        $.setCss(['width', '200px']),\n        $.setCss(['height', '100px']),\n        $.setCss(['border-radius', '4px']),\n      )($(`.${WINDOW_CONTAINER}`));\n\n      this.btnOk = $(`.${WINDOW_BTN_OK}`);\n      this.btnCancel = $(`.${WINDOW_BTN_CANCEL}`);\n\n      this.addListeners(item.callback);\n    }\n\n    build(item) {\n      const {\n        type,\n        message,\n      } = item;\n\n      let title = typeof message === 'string' ? message : message.title;\n      let text = typeof message === 'object' ? message.text : '';\n\n      let html = '';\n      let header, body, footer;\n\n      // header\n      header = `\n        <header class=${WINDOW_HEADER}>\n          <div>\n            ${this.elements.title.replace('{{title}}', title)}\n          </div>\n        </header>\n      `;\n      // body\n      body = `\n      <section class=${WINDOW_BODY}>\n        ${this.elements.text.replace('{{text}}', text)}\n      </section>`;\n\n      switch (type) {\n        case 'confirm':\n          footer = `\n            <footer class=${WINDOW_FOOTER}>\n              ${this.elements.buttons.ok.replace('{{ok}}', this.labels.ok)}\n              ${this.elements.buttons.cancel.replace('{{cancel}}', this.labels.cancel)}\n            </footer>\n          `;\n          break;\n\n        case 'alert':\n          footer =\n            `<footer class=${WINDOW_FOOTER}>\n              ${this.elements.buttons.ok.replace('{{ok}}', this.labels.ok)}\n            </footer>`;\n          break;\n      }\n\n      html += `<div class=${WINDOW_CONTAINER}>`\n      html += header;\n      html += body;\n      html += footer;\n      html += '</div>';\n      return html;\n    }\n\n    addListeners(fn) {\n      const hasOK = !!this.btnOk;\n      const hasCancel = !!this.btnCancel;\n\n      let key, common, ok, cancel;\n\n      key = (event) => {\n        const keyCode = event.keyCode;\n        if ((keyCode === KEYS.ENTER || keyCode === KEYS.SPACE)) return ok(event);\n        if (keyCode === KEYS.ESC) return cancel(event);\n      }\n\n      common = () => {\n        this.eventUnBind(document.body, 'keyup', key);\n        if (hasOK) {\n          this.eventUnBind(this.btnOk, 'click', ok);\n        }\n\n        if (hasCancel) {\n          this.eventUnBind(this.btnCancel, 'click', cancel);\n        }\n\n        this.close();\n      }\n\n      ok = (event) => {\n        if (event.preventDefault) event.preventDefault();\n        common();\n        fn(null, true);\n      }\n\n      cancel = (event) => {\n        if (event.preventDefault) event.preventDefault();\n        common();\n        fn(null, false);\n      }\n\n      if (hasOK) this.eventBind(this.btnOk, 'click', ok);\n      if (hasCancel) this.eventBind(this.btnCancel, 'click', cancel);\n      this.eventBind(document.body, 'keyup', key);\n    }\n\n    eventBind(el, event, fn) {\n      if (typeof el.addEventListener === 'function') {\n        el.addEventListener(event, fn);\n      } else if (el.attachEvent) {\n        el.attachEvent(\"on\" + event, fn);\n      }\n    }\n\n    eventUnBind(el, event, fn) {\n      if (typeof el.removeEventListener === \"function\") {\n        el.removeEventListener(event, fn);\n      } else if (el.detachEvent) {\n        el.detachEvent(\"on\" + event, fn);\n      }\n    }\n\n    close() {\n      if (this.elWindow) {\n        $.remove(this.elWindow);\n      }\n    }\n\n    dialog(type, message, callback) {\n      function validation(message) {\n        if (typeof message === 'string') return true;\n        if (typeof message === 'object' && typeof message.title === 'string') return;\n        return false;\n      }\n\n      if (!validation(message)) throw new Error('message must be a string or object!');\n      if ($(`.${WINDOW_EL}`)) return;\n\n      const item = { type, message, callback };\n      this.init();\n      this.setup(item);\n    }\n\n    alertSet(type) {\n      return (message) => toPromise(this.dialog)(type, message);\n    }\n  }\n\n  window.AlertWindow = new AlertWindow();\n}(window));\n\n"],"names":["window","KEYS","WINDOW_EL","WINDOW_TITLE","WINDOW_TEXT","WINDOW_BTN","WINDOW_BTN_OK","WINDOW_BTN_CANCEL","WINDOW_BTN_SUBMIT","AlertWindow","labels","elements","init","this","bind","setup","dialog","alertSet","addListeners","alert","confirm","elWindow","$","el","body","pipe","setCss","append","item","innerHTML","build","btnOk","btnCancel","callback","header","type","message","title","text","html","footer","replace","buttons","ok","cancel","fn","key","common","hasOK","hasCancel","event","keyCode","eventUnBind","document","_this","close","preventDefault","eventBind","addEventListener","attachEvent","removeEventListener","detachEvent","remove","validation","Error","toPromise","_this2"],"mappings":"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"}