{"version":3,"file":"alert.js","sources":["../lib/alert.js"],"sourcesContent":["\n(!function (window) {\n  const KEYS = { ENTER: 13, ESC: 27, SPACE: 32 };\n\n  const WINDOW_EL = 'alert-window';\n  const WINDOW_TITLE = 'alert-window-title';\n  const WINDOW_TEXT = 'alert-window-text';\n  const WINDOW_BODY = 'alert-window-body';\n  const WINDOW_HEADER = 'alert-window-header';\n  const WINDOW_FOOTER = 'alert-window-footer';\n  const WINDOW_CONTAINER = 'alert-window-container';\n\n  const WINDOW_BTN = 'alert-window-btn';\n  const WINDOW_BTN_OK = 'alert-window-btn-ok';\n  const WINDOW_BTN_CANCEL = 'alert-window-btn-cancel';\n  const WINDOW_BTN_SUBMIT = 'alert-window-btn-submit';\n\n  class AlertWindow {\n    constructor() {\n      this.labels = {\n        ok: \"OK\",\n        cancel: \"Cancel\"\n      }\n\n      this.elements = {\n        body: `<div class=${WINDOW_EL}></div>`,\n        buttons: {\n          submit: `<button type=\"submit\" class=\"${WINDOW_BTN} ${WINDOW_BTN_SUBMIT}\">{{ok}}</button>`,\n          ok: `<button class=\"${WINDOW_BTN} ${WINDOW_BTN_OK}\">{{ok}}</button>`,\n          cancel: `<button class=\"${WINDOW_BTN} ${WINDOW_BTN_CANCEL}\">{{cancel}}</button>`\n        },\n\n        title: `<p class=\"${WINDOW_TITLE}\">{{title}}</p>`,\n        text: `<p class=\"${WINDOW_TEXT}\">{{text}}</p>`,\n      }\n\n      this.init = this.init.bind(this);\n      this.setup = this.setup.bind(this);\n      this.dialog = this.dialog.bind(this);\n      this.alertSet = this.alertSet.bind(this);\n      this.addListeners = this.addListeners.bind(this);\n\n      this.alert = this.alertSet('alert');\n      this.confirm = this.alertSet('confirm');\n    }\n\n    init() {\n      this.elWindow = $.el(this.elements.body);\n      return pipe(\n        // css\n        $.setCss(['position', 'fixed']),\n        $.setCss(['top', 0]),\n        $.setCss(['left', 0]),\n        $.setCss(['right', 0]),\n        $.setCss(['bottom', 0]),\n        $.setCss(['background', 'rgba(0, 0, 0, 0.2)']),\n        $.setCss(['z-index', 1000]),\n        // append\n        $.append($('body')),\n      )(this.elWindow);\n    }\n\n    setup(item) {\n      this.elWindow = $(`.${WINDOW_EL}`);\n      this.elWindow.innerHTML = this.build(item);\n\n      pipe(\n        $.setCss(['position', 'relative']),\n        $.setCss(['top', '25%']),\n        $.setCss(['left', '50%']),\n        $.setCss(['transform', 'translate(-50%,-50%)']),\n        $.setCss(['background', '#fff']),\n        $.setCss(['width', '200px']),\n        $.setCss(['height', '100px']),\n        $.setCss(['border-radius', '4px']),\n      )($(`.${WINDOW_CONTAINER}`));\n\n      this.btnOk = $(`.${WINDOW_BTN_OK}`);\n      this.btnCancel = $(`.${WINDOW_BTN_CANCEL}`);\n\n      this.addListeners(item.callback);\n    }\n\n    build(item) {\n      const {\n        type,\n        message,\n      } = item;\n\n      let title = typeof message === 'string' ? message : message.title;\n      let text = typeof message === 'object' ? message.text : '';\n\n      let html = '';\n      let header, body, footer;\n\n      // header\n      header = `\n        <header class=${WINDOW_HEADER}>\n          <div>\n            ${this.elements.title.replace('{{title}}', title)}\n          </div>\n        </header>\n      `;\n      // body\n      body = `\n      <section class=${WINDOW_BODY}>\n        ${this.elements.text.replace('{{text}}', text)}\n      </section>`;\n\n      switch (type) {\n        case 'confirm':\n          footer = `\n            <footer class=${WINDOW_FOOTER}>\n              ${this.elements.buttons.ok.replace('{{ok}}', this.labels.ok)}\n              ${this.elements.buttons.cancel.replace('{{cancel}}', this.labels.cancel)}\n            </footer>\n          `;\n          break;\n\n        case 'alert':\n          footer =\n            `<footer class=${WINDOW_FOOTER}>\n              ${this.elements.buttons.ok.replace('{{ok}}', this.labels.ok)}\n            </footer>`;\n          break;\n      }\n\n      html += `<div class=${WINDOW_CONTAINER}>`\n      html += header;\n      html += body;\n      html += footer;\n      html += '</div>';\n      return html;\n    }\n\n    addListeners(fn) {\n      const hasOK = !!this.btnOk;\n      const hasCancel = !!this.btnCancel;\n\n      let key, common, ok, cancel;\n\n      key = (event) => {\n        const keyCode = event.keyCode;\n        if ((keyCode === KEYS.ENTER || keyCode === KEYS.SPACE)) return ok(event);\n        if (keyCode === KEYS.ESC) return cancel(event);\n      }\n\n      common = () => {\n        this.eventUnBind(document.body, 'keyup', key);\n        if (hasOK) {\n          this.eventUnBind(this.btnOk, 'click', ok);\n        }\n\n        if (hasCancel) {\n          this.eventUnBind(this.btnCancel, 'click', cancel);\n        }\n\n        this.close();\n      }\n\n      ok = (event) => {\n        if (event.preventDefault) event.preventDefault();\n        common();\n        fn(null, true);\n      }\n\n      cancel = (event) => {\n        if (event.preventDefault) event.preventDefault();\n        common();\n        fn(null, false);\n      }\n\n      if (hasOK) this.eventBind(this.btnOk, 'click', ok);\n      if (hasCancel) this.eventBind(this.btnCancel, 'click', cancel);\n      this.eventBind(document.body, 'keyup', key);\n    }\n\n    eventBind(el, event, fn) {\n      if (typeof el.addEventListener === 'function') {\n        el.addEventListener(event, fn);\n      } else if (el.attachEvent) {\n        el.attachEvent(\"on\" + event, fn);\n      }\n    }\n\n    eventUnBind(el, event, fn) {\n      if (typeof el.removeEventListener === \"function\") {\n        el.removeEventListener(event, fn);\n      } else if (el.detachEvent) {\n        el.detachEvent(\"on\" + event, fn);\n      }\n    }\n\n    close() {\n      if (this.elWindow) {\n        $.remove(this.elWindow);\n      }\n    }\n\n    dialog(type, message, callback) {\n      function validation(message) {\n        if (typeof message === 'string') return true;\n        if (typeof message === 'object' && typeof message.title === 'string') return;\n        return false;\n      }\n\n      if (!validation(message)) throw new Error('message must be a string or object!');\n      if ($(`.${WINDOW_EL}`)) return;\n\n      const item = { type, message, callback };\n      this.init();\n      this.setup(item);\n    }\n\n    alertSet(type) {\n      return (message) => toPromise(this.dialog)(type, message);\n    }\n  }\n\n  window.AlertWindow = new AlertWindow();\n}(window));\n\n"],"names":["window","KEYS","ENTER","ESC","SPACE","WINDOW_EL","WINDOW_TITLE","WINDOW_TEXT","WINDOW_BODY","WINDOW_HEADER","WINDOW_FOOTER","WINDOW_CONTAINER","WINDOW_BTN","WINDOW_BTN_OK","WINDOW_BTN_CANCEL","WINDOW_BTN_SUBMIT","AlertWindow","labels","elements","init","bind","setup","dialog","alertSet","addListeners","alert","confirm","elWindow","$","el","body","pipe","setCss","append","item","innerHTML","build","btnOk","btnCancel","callback","type","message","title","text","html","header","footer","replace","buttons","ok","cancel","fn","hasOK","hasCancel","key","common","event","keyCode","eventUnBind","document","close","preventDefault","eventBind","addEventListener","attachEvent","removeEventListener","detachEvent","remove","validation","Error","toPromise"],"mappings":"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"}